<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <title>Business Data Analysis Tool</title>
</head>
<body>
    <header>
        <h1>Business Data Analysis Tool</h1>
    </header>
    <main>
        <div id="intro">
            <div id="intro-guide">
                <h2>User Guide</h2>
                <ul>
                    <li>The tool only supports .xlsx format file.</li>
                    <li>
                        The standard format of the Excel file consists of 4 columns
                        <ol>
                            <li>month</li>
                            <li>sales</li>
                            <li>revenue</li>
                            <li>expenses</li>
                        </ol>
                    </li>
                    <li>Please download the template Excel file <a href="sample.xlsx" download="sample.xlsx">here</a></li>
                </ul>
            </div>
            <div id="intro-function">
                <h2>Tool Function</h2>
                <ul>
                    <li>Generate line charts of sales, revenue and expenses</li>
                    <li>Generate regression trendlines of the time series of the data</li>
                    <li>Generate bar charts of sales, revenue and expenses</li>
                    <li>Generate scatter plots of sales, revenue and expenses with correlation calculated</li>
                </ul>
            </div>
        </div>

        <form id="upload-section">
            <h2>Upload Excel File</h2>
            <input type="file" id="file-input" accept=".xlsx" required>
            <button id="analyze-button">Analyze</button>
        </form>
        <hr/>
        <section id="analysis-section" hidden>
            <h2 id="analysis-title" class="title">Data Analysis</h2>
            <h3 id="line-charts-title" class="title">Line Chart of Sales, Revenue & Expenses</h3>
            <div id="charts" classs="chart"></div>
            <hr/>
            <h3 id="line-regress-title" class="title">Regression Analysis of Time Series</h3>
            <h4>Time Series Linear Regression of Sales</h4>
            <div id="regress-chart-sales" class="chart"></div>
            <div id="regress-result-sales"></div>
            <h4>Time Series Linear Regression of Revenue</h4>
            <div id="regress-chart-revenue" classs="chart"></div>
            <div id="regress-result-revenue"></div>
            <h4>Time Series Linear Regression of Expenses</h4>
            <div id="regress-chart-expenses" classs="chart"></div>
            <div id="regress-result-expenses"></div>
            <hr/>
            <h3 id="bar-charts-title" class="title">Bar Chart of Sales, Revenue & Expenses</h3>
            <div id="bar_charts"></div>
            <hr/>
            <h3 id="scatter-charts-title" class="title">Scatter plot of Sales, Revenue & Expenses</h3>
            <h4> Scatter plot of Revenue versus Sales</h4>
            <div id="scatter-rvs"></div>
            <div id="correlation-rvs"></div>
            <h4> Scatter plot of Revenue versus Expenses</h4>
            <div id="scatter-rve"></div>
            <div id="correlation-rve"></div>
            <h4> Scatter plot of Expenses versus Sales</h4>
            <div id="scatter-evs"></div>
            <div id="correlation-evs"></div>

            <h3>Raw Data</h3>
            <div id="testing"></div>
        </section>
    </main>
    <footer>
        <p>&copy; 2023 AlfredC & DonaldC</p>
    </footer>
    <script src="script.js"></script>
</body>
</html>